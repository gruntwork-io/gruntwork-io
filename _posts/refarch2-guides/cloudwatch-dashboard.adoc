---
title: cloudwatch-dashboard Service Migration Guide
categories: Upgrades
image: /assets/img/guides/refresh_icon.png
excerpt: Learn how to update your v1 Reference Architecture to use the Gruntwork Service Catalog.
tags: ["aws", "terraform", "terragrunt"]
cloud: ["aws"]
redirect_from: /static/guides/upgrades/how-to-update-your-ref-arch/
---
:page-type: guide
:page-layout: post

:toc:
:toc-placement!:

// GitHub specific settings. See https://gist.github.com/dcode/0cfbf2699a1fe9b46ff04c41721dda74 for details.
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
toc::[]
endif::[]

== cloudwatch-dashboard Service Migration Guide

*NOTE: There is no service catalog module for the CloudWatch Dashboard service, but the library module
(`[cloudwatch-dashboard](https://github.com/gruntwork-io/terraform-aws-monitoring/tree/master/modules/metrics/cloudwatch-dashboard)`)
is designed to be deployed directly, like a Service Catalog module.*

=== Estimated Time to Migrate: 15 minutes per environment

=== Dashboards Input

Configure the new `dashboards` input.

In the Service Catalog version of the `cloudwatch-dashboard` module, we specify all the widgets manually in the
`terragrunt.hcl` configuration instead of the module as we did before. This means that it is necessary to specify all
the widgets you want to expose in your CloudWatch dashboard.

To migrate, set the `dashboards` input with the key as the name and the value as the list of widget json values. For
example if you had:

[source,python]
----
inputs = {
  name = "DevServicesDashboard"
}
----

[source,python]
----
inputs = {
  DevServicesDashboard = concat(
    dependency.database.outputs.metric_widget_rds_cpu_usage,
    dependency.database.outputs.metric_widget_rds_memory,
    dependency.database.outputs.metric_widget_rds_disk_space,
    dependency.database.outputs.metric_widget_rds_db_connections,
    dependency.database.outputs.metric_widget_rds_read_latency,
    dependency.database.outputs.metric_widget_rds_write_latency,
    )
}
----

=== Breaking Changes

* This operation will recreate the dashboard (destroy + create). The dashboard will not be available for during the
operation (< 1 minute). If you wish to maintain continuous access to the dashboard, you can do the following state mv
operation:
+
[source,python]
----
terragrunt state mv \
  'module.dashboard.aws_cloudwatch_dashboard.dashboard["DevServicesDashboard"]' \
  'aws_cloudwatch_dashboard.dashboard["DevServicesDashboard"]'
----
